<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Polars Usage" href="polars_usage.html" /><link rel="prev" title="Pandas Usage" href="pandas_usage.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Spark Usage - datacompy 0.11.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">datacompy 0.11.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">datacompy 0.11.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandas_usage.html">Pandas Usage</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Spark Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="polars_usage.html">Polars Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="fugue_usage.html">Fugue Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_instructions.html">Developer Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/modules.html">datacompy</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of datacompy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/datacompy.html">datacompy package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/capitalone/datacompy">Github Repo</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="spark-usage">
<h1>Spark Usage<a class="headerlink" href="#spark-usage" title="Link to this heading">#</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>With version <code class="docutils literal notranslate"><span class="pre">v0.9.0</span></code> SparkCompare now uses Null Safe (<code class="docutils literal notranslate"><span class="pre">&lt;=&gt;</span></code>) comparisons</p>
</div>
<p>DataComPy’s <code class="docutils literal notranslate"><span class="pre">SparkCompare</span></code> class will join two dataframes either on a list of join
columns. It has the capability to map column names that may be different in each
dataframe, including in the join columns. You are responsible for creating the
dataframes from any source which Spark can handle and specifying a unique join
key. If there are duplicates in either dataframe by join key, the match process
will remove the duplicates before joining (and tell you how many duplicates were
found).</p>
<p>As with the Pandas-based <code class="docutils literal notranslate"><span class="pre">Compare</span></code> class, comparisons will be attempted even
if dtypes don’t match. Any schema differences will be reported in the output
as well as in any mismatch reports, so that you can assess whether or not a
type mismatch is a problem or not.</p>
<p>The main reasons why you would choose to use <code class="docutils literal notranslate"><span class="pre">SparkCompare</span></code> over <code class="docutils literal notranslate"><span class="pre">Compare</span></code>
are that your data is too large to fit into memory, or you’re comparing data
that works well in a Spark environment, like partitioned Parquet, CSV, or JSON
files, or Cerebro tables.</p>
<section id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">datacompy</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>

<span class="c1"># This example assumes you have a SparkSession named &quot;spark&quot; in your environment, as you</span>
<span class="c1"># do when running `pyspark` from the terminal or in a Databricks notebook (Spark v2.0 and higher)</span>

<span class="n">data1</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001234</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">123.45</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;George Maharis&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="mf">14530.1555</span><span class="p">,</span>
        <span class="n">date_fld</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001235</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Michael Bluth&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">date_fld</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001236</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">1345.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;George Bluth&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">date_fld</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001237</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">123456.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bob Loblaw&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="mf">345.12</span><span class="p">,</span>
        <span class="n">date_fld</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001239</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lucille Bluth&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">date_fld</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">]</span>

<span class="n">data2</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001234</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">123.4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;George Michael Bluth&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="mf">14530.155</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001235</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Michael Bluth&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001236</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">1345.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;George Bluth&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001237</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">123456.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Robert Loblaw&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="mf">345.12</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001238</span><span class="p">,</span> <span class="n">dollar_amt</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Loose Seal Bluth&#39;</span><span class="p">,</span> <span class="n">float_fld</span><span class="o">=</span><span class="mf">111.0</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">base_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">compare_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="n">comparison</span> <span class="o">=</span> <span class="n">datacompy</span><span class="o">.</span><span class="n">SparkCompare</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">base_df</span><span class="p">,</span> <span class="n">compare_df</span><span class="p">,</span> <span class="n">join_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;acct_id&#39;</span><span class="p">])</span>

<span class="c1"># This prints out a human-readable report summarizing differences</span>
<span class="n">comparison</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="using-sparkcompare-on-emr-or-standalone-spark">
<h2>Using SparkCompare on EMR or standalone Spark<a class="headerlink" href="#using-sparkcompare-on-emr-or-standalone-spark" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Set proxy variables</p></li>
<li><p>Create a virtual environment, if desired (<code class="docutils literal notranslate"><span class="pre">virtualenv</span> <span class="pre">venv;</span> <span class="pre">source</span> <span class="pre">venv/bin/activate</span></code>)</p></li>
<li><p>Pip install datacompy and requirements</p></li>
<li><p>Ensure your SPARK_HOME environment variable is set (this is probably <code class="docutils literal notranslate"><span class="pre">/usr/lib/spark</span></code> but may
differ based on your installation)</p></li>
<li><p>Augment your PYTHONPATH environment variable with
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">PYTHONPATH=$SPARK_HOME/python/lib/py4j-0.10.4-src.zip:$SPARK_HOME/python:$PYTHONPATH</span></code>
(note that your version of py4j may differ depending on the version of Spark you’re using)</p></li>
</ol>
</section>
<section id="using-sparkcompare-on-databricks">
<h2>Using SparkCompare on Databricks<a class="headerlink" href="#using-sparkcompare-on-databricks" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Clone this repository locally</p></li>
<li><p>Create a datacompy egg by running <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">bdist_egg</span></code> from the repo root directory.</p></li>
<li><p>From the Databricks front page, click the “Library” link under the “New” section.</p></li>
<li><dl class="simple">
<dt>On the New library page:</dt><dd><ol class="loweralpha simple">
<li><p>Change source to “Upload Python Egg or PyPi”</p></li>
<li><p>Under “Upload Egg”, Library Name should be “datacompy”</p></li>
<li><p>Drag the egg file in datacompy/dist/ to the “Drop library egg here to upload” box</p></li>
<li><p>Click the “Create Library” button</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>Once the library has been created, from the library page (which you can find in your /Users/{login} workspace),
you can choose clusters to attach the library to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">datacompy</span></code> in a notebook attached to the cluster that the library is attached to and enjoy!</p></li>
</ol>
</section>
<section id="performance-implications">
<h2>Performance Implications<a class="headerlink" href="#performance-implications" title="Link to this heading">#</a></h2>
<p>Spark scales incredibly well, so you can use <code class="docutils literal notranslate"><span class="pre">SparkCompare</span></code> to compare
billions of rows of data, provided you spin up a big enough cluster. Still,
joining billions of rows of data is an inherently large task, so there are a
couple of things you may want to take into consideration when getting into the
cliched realm of “big data”:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SparkCompare</span></code> will compare all columns in common in the dataframes and
report on the rest. If there are columns in the data that you don’t care to
compare, use a <code class="docutils literal notranslate"><span class="pre">select</span></code> statement/method on the dataframe(s) to filter
those out. Particularly when reading from wide Parquet files, this can make
a huge difference when the columns you don’t care about don’t have to be
read into memory and included in the joined dataframe.</p></li>
<li><p>For large datasets, adding <code class="docutils literal notranslate"><span class="pre">cache_intermediates=True</span></code> to the <code class="docutils literal notranslate"><span class="pre">SparkCompare</span></code>
call can help optimize performance by caching certain intermediate dataframes
in memory, like the de-duped version of each input dataset, or the joined
dataframe. Otherwise, Spark’s lazy evaluation will recompute those each time
it needs the data in a report or as you access instance attributes. This may
be fine for smaller dataframes, but will be costly for larger ones. You do
need to ensure that you have enough free cache memory before you do this, so
this parameter is set to False by default.</p></li>
</ul>
</section>
<section id="known-differences">
<h2>Known Differences<a class="headerlink" href="#known-differences" title="Link to this heading">#</a></h2>
<p>For cases when two dataframes are expected to differ, it can be helpful to cluster detected
differences into three categories: matches, known differences, and true mismatches. Known
differences can be specified through an optional parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SparkCompare</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">base_df</span><span class="p">,</span> <span class="n">compare_df</span><span class="p">,</span> <span class="n">join_columns</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">column_mapping</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="n">known_differences</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
         <span class="s1">&#39;name&#39;</span><span class="p">:</span>  <span class="s2">&quot;My Known Difference Name&quot;</span><span class="p">,</span>
         <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;bigint&#39;</span><span class="p">],</span>
         <span class="s1">&#39;flags&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;nullcheck&#39;</span><span class="p">],</span>
         <span class="s1">&#39;transformation&#39;</span><span class="p">:</span> <span class="s2">&quot;case when </span><span class="si">{input}</span><span class="s2">=0 then null else </span><span class="si">{input}</span><span class="s2"> end&quot;</span>
        <span class="p">},</span>
        <span class="o">...</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The ‘known_differences’ parameter is a list of Python dicts with the following fields:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Required?</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>yes</p></td>
<td><p>A user-readable title for this known difference</p></td>
</tr>
<tr class="row-odd"><td><p>types</p></td>
<td><p>yes</p></td>
<td><p>A list of Spark data types on which this transformation can be applied</p></td>
</tr>
<tr class="row-even"><td><p>flags</p></td>
<td><p>no</p></td>
<td><p>Special flags used for computing known differences</p></td>
</tr>
<tr class="row-odd"><td><p>transformation</p></td>
<td><p>yes</p></td>
<td><p>Spark SQL function to apply, where {input} is a cell in the comparison</p></td>
</tr>
</tbody>
</table>
</div>
<p>Valid flags are:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>nullcheck</p></td>
<td><p>Must be set when the output of the transformation can be null</p></td>
</tr>
</tbody>
</table>
</div>
<p>Transformations are applied to the compare side only. A known difference is found when transformation(compare.cell) equals base.cell. An example comparison is shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">datacompy</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>

<span class="n">base_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001234</span><span class="p">,</span> <span class="n">acct_sfx_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">clsd_reas_cd</span><span class="o">=</span><span class="s1">&#39;*2&#39;</span><span class="p">,</span> <span class="n">open_dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">tbal_cd</span><span class="o">=</span><span class="s1">&#39;0001&#39;</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001235</span><span class="p">,</span> <span class="n">acct_sfx_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">clsd_reas_cd</span><span class="o">=</span><span class="s1">&#39;V1&#39;</span><span class="p">,</span> <span class="n">open_dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">tbal_cd</span><span class="o">=</span><span class="s1">&#39;0002&#39;</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001236</span><span class="p">,</span> <span class="n">acct_sfx_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">clsd_reas_cd</span><span class="o">=</span><span class="s1">&#39;V2&#39;</span><span class="p">,</span> <span class="n">open_dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">tbal_cd</span><span class="o">=</span><span class="s1">&#39;0003&#39;</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001237</span><span class="p">,</span> <span class="n">acct_sfx_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">clsd_reas_cd</span><span class="o">=</span><span class="s1">&#39;*2&#39;</span><span class="p">,</span> <span class="n">open_dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">tbal_cd</span><span class="o">=</span><span class="s1">&#39;0004&#39;</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">acct_id</span><span class="o">=</span><span class="mi">10000001238</span><span class="p">,</span> <span class="n">acct_sfx_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">clsd_reas_cd</span><span class="o">=</span><span class="s1">&#39;*2&#39;</span><span class="p">,</span> <span class="n">open_dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">tbal_cd</span><span class="o">=</span><span class="s1">&#39;0005&#39;</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">base_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">base_data</span><span class="p">)</span>

<span class="n">compare_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">ACCOUNT_IDENTIFIER</span><span class="o">=</span><span class="mi">10000001234</span><span class="p">,</span> <span class="n">SUFFIX_NUMBER</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">AM00_STATC_CLOSED</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">AM00_DATE_ACCOUNT_OPEN</span><span class="o">=</span><span class="mi">2017121</span><span class="p">,</span> <span class="n">AM0B_FC_TBAL</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">ACCOUNT_IDENTIFIER</span><span class="o">=</span><span class="mi">10000001235</span><span class="p">,</span> <span class="n">SUFFIX_NUMBER</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">AM00_STATC_CLOSED</span><span class="o">=</span><span class="s1">&#39;V1&#39;</span><span class="p">,</span> <span class="n">AM00_DATE_ACCOUNT_OPEN</span><span class="o">=</span><span class="mi">2017122</span><span class="p">,</span> <span class="n">AM0B_FC_TBAL</span><span class="o">=</span><span class="mf">2.0</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">ACCOUNT_IDENTIFIER</span><span class="o">=</span><span class="mi">10000001236</span><span class="p">,</span> <span class="n">SUFFIX_NUMBER</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">AM00_STATC_CLOSED</span><span class="o">=</span><span class="s1">&#39;V2&#39;</span><span class="p">,</span> <span class="n">AM00_DATE_ACCOUNT_OPEN</span><span class="o">=</span><span class="mi">2017123</span><span class="p">,</span> <span class="n">AM0B_FC_TBAL</span><span class="o">=</span><span class="mf">3.0</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">ACCOUNT_IDENTIFIER</span><span class="o">=</span><span class="mi">10000001237</span><span class="p">,</span> <span class="n">SUFFIX_NUMBER</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">AM00_STATC_CLOSED</span><span class="o">=</span><span class="s1">&#39;V3&#39;</span><span class="p">,</span> <span class="n">AM00_DATE_ACCOUNT_OPEN</span><span class="o">=</span><span class="mi">2017124</span><span class="p">,</span> <span class="n">AM0B_FC_TBAL</span><span class="o">=</span><span class="mf">4.0</span><span class="p">),</span>
    <span class="n">Row</span><span class="p">(</span><span class="n">ACCOUNT_IDENTIFIER</span><span class="o">=</span><span class="mi">10000001238</span><span class="p">,</span> <span class="n">SUFFIX_NUMBER</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">AM00_STATC_CLOSED</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">AM00_DATE_ACCOUNT_OPEN</span><span class="o">=</span><span class="mi">2017125</span><span class="p">,</span> <span class="n">AM0B_FC_TBAL</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">compare_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">compare_data</span><span class="p">)</span>

<span class="n">comparison</span> <span class="o">=</span> <span class="n">datacompy</span><span class="o">.</span><span class="n">SparkCompare</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">base_df</span><span class="p">,</span> <span class="n">compare_df</span><span class="p">,</span>
                    <span class="n">join_columns</span> <span class="o">=</span>   <span class="p">[(</span><span class="s1">&#39;acct_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCOUNT_IDENTIFIER&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;acct_sfx_num&#39;</span><span class="p">,</span> <span class="s1">&#39;SUFFIX_NUMBER&#39;</span><span class="p">)],</span>
                    <span class="n">column_mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;clsd_reas_cd&#39;</span><span class="p">,</span> <span class="s1">&#39;AM00_STATC_CLOSED&#39;</span><span class="p">),</span>
                                      <span class="p">(</span><span class="s1">&#39;open_dt&#39;</span><span class="p">,</span> <span class="s1">&#39;AM00_DATE_ACCOUNT_OPEN&#39;</span><span class="p">),</span>
                                      <span class="p">(</span><span class="s1">&#39;tbal_cd&#39;</span><span class="p">,</span> <span class="s1">&#39;AM0B_FC_TBAL&#39;</span><span class="p">)],</span>
                    <span class="n">known_differences</span><span class="o">=</span> <span class="p">[</span>
                        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Left-padded, four-digit numeric code&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;tinyint&#39;</span><span class="p">,</span> <span class="s1">&#39;smallint&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;bigint&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;double&#39;</span><span class="p">,</span> <span class="s1">&#39;decimal&#39;</span><span class="p">],</span>
                         <span class="s1">&#39;transformation&#39;</span><span class="p">:</span> <span class="s2">&quot;lpad(cast(</span><span class="si">{input}</span><span class="s2"> AS bigint), 4, &#39;0&#39;)&quot;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Null to *2&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">],</span>
                         <span class="s1">&#39;transformation&#39;</span><span class="p">:</span> <span class="s2">&quot;case when </span><span class="si">{input}</span><span class="s2"> is null then &#39;*2&#39; else </span><span class="si">{input}</span><span class="s2"> end&quot;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Julian date -&gt; date&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bigint&#39;</span><span class="p">],</span>
                         <span class="s1">&#39;transformation&#39;</span><span class="p">:</span> <span class="s2">&quot;to_date(cast(unix_timestamp(cast(</span><span class="si">{input}</span><span class="s2"> AS string), &#39;yyyyDDD&#39;) AS timestamp))&quot;</span><span class="p">}</span>
                    <span class="p">])</span>
<span class="n">comparison</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<p>Corresponding output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">******</span> <span class="n">Column</span> <span class="n">Summary</span> <span class="o">******</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">common</span> <span class="k">with</span> <span class="n">matching</span> <span class="n">schemas</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">common</span> <span class="k">with</span> <span class="n">schema</span> <span class="n">differences</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">base</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">compare</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">base</span><span class="p">:</span> <span class="mi">0</span>

<span class="o">******</span> <span class="n">Schema</span> <span class="n">Differences</span> <span class="o">******</span>
<span class="n">Base</span> <span class="n">Column</span> <span class="n">Name</span>  <span class="n">Compare</span> <span class="n">Column</span> <span class="n">Name</span>     <span class="n">Base</span> <span class="n">Dtype</span>     <span class="n">Compare</span> <span class="n">Dtype</span>
<span class="o">----------------</span>  <span class="o">----------------------</span>  <span class="o">-------------</span>  <span class="o">-------------</span>
<span class="n">open_dt</span>           <span class="n">AM00_DATE_ACCOUNT_OPEN</span>  <span class="n">date</span>           <span class="n">bigint</span>
<span class="n">tbal_cd</span>           <span class="n">AM0B_FC_TBAL</span>            <span class="n">string</span>         <span class="n">double</span>

<span class="o">******</span> <span class="n">Row</span> <span class="n">Summary</span> <span class="o">******</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">common</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">base</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">compare</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">base</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">duplicate</span> <span class="n">rows</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">base</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">duplicate</span> <span class="n">rows</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">compare</span><span class="p">:</span> <span class="mi">0</span>

<span class="o">******</span> <span class="n">Row</span> <span class="n">Comparison</span> <span class="o">******</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">rows</span> <span class="k">with</span> <span class="n">some</span> <span class="n">columns</span> <span class="n">unequal</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">rows</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">columns</span> <span class="n">equal</span><span class="p">:</span> <span class="mi">0</span>

<span class="o">******</span> <span class="n">Column</span> <span class="n">Comparison</span> <span class="o">******</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">columns</span> <span class="n">compared</span> <span class="k">with</span> <span class="n">unexpected</span> <span class="n">differences</span> <span class="ow">in</span> <span class="n">some</span> <span class="n">values</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">columns</span> <span class="n">compared</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">values</span> <span class="n">equal</span> <span class="n">but</span> <span class="n">known</span> <span class="n">differences</span> <span class="n">found</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">columns</span> <span class="n">compared</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">values</span> <span class="n">completely</span> <span class="n">equal</span><span class="p">:</span> <span class="mi">0</span>

<span class="o">******</span> <span class="n">Columns</span> <span class="k">with</span> <span class="n">Unequal</span> <span class="n">Values</span> <span class="o">******</span>
<span class="n">Base</span> <span class="n">Column</span> <span class="n">Name</span>  <span class="n">Compare</span> <span class="n">Column</span> <span class="n">Name</span>     <span class="n">Base</span> <span class="n">Dtype</span>     <span class="n">Compare</span> <span class="n">Dtype</span>  <span class="c1"># Matches  # Known Diffs  # Mismatches</span>
<span class="o">----------------</span>  <span class="o">-------------------</span>     <span class="o">-------------</span>  <span class="o">-------------</span>  <span class="o">---------</span>  <span class="o">-------------</span>  <span class="o">------------</span>
<span class="n">clsd_reas_cd</span>      <span class="n">AM00_STATC_CLOSED</span>       <span class="n">string</span>         <span class="n">string</span>                 <span class="mi">2</span>              <span class="mi">2</span>             <span class="mi">1</span>
<span class="n">open_dt</span>           <span class="n">AM00_DATE_ACCOUNT_OPEN</span>  <span class="n">date</span>           <span class="n">bigint</span>                 <span class="mi">0</span>              <span class="mi">5</span>             <span class="mi">0</span>
<span class="n">tbal_cd</span>           <span class="n">AM0B_FC_TBAL</span>            <span class="n">string</span>         <span class="n">double</span>                 <span class="mi">0</span>              <span class="mi">5</span>             <span class="mi">0</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="polars_usage.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Polars Usage</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="pandas_usage.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Pandas Usage</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Capital One
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Spark Usage</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li><a class="reference internal" href="#using-sparkcompare-on-emr-or-standalone-spark">Using SparkCompare on EMR or standalone Spark</a></li>
<li><a class="reference internal" href="#using-sparkcompare-on-databricks">Using SparkCompare on Databricks</a></li>
<li><a class="reference internal" href="#performance-implications">Performance Implications</a></li>
<li><a class="reference internal" href="#known-differences">Known Differences</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=57cbeb03"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>